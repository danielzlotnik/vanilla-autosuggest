function Autosuggest(e){function t(e){var t=document.createElement(e.tag);for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function n(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function o(e){var t=String.fromCharCode(e);return/[a-zA-Z0-9-_ \b]/.test(t)}function s(e,t){return!!e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))}function i(e,t){s(e,t)||(e.className+=" "+t)}function u(e,t){if(s(e,t)){var n=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(n," ")}}function g(e,t){for(var n=(t=(t=t.replace(/\[(\w+)\]/g,".$1")).replace(/^\./,"")).split("."),o=0,s=n.length;o<s;++o){var i=n[o];if(!(i in e))return;e=e[i]}return e}function r(e){return e?parseInt(e.split("-")[1]):-1}function a(e,t){return e?e.replace(new RegExp(t,"ig"),"<strong>"+t+"</strong>"):""}function d(e){n(h),m.suggestions=m.getSuggestions(e),m.suggestionsCount=m.suggestions.length,m.focusedSuggestionId=void 0;for(var o=0;o<Math.min(m.suggestions.length,m.maxSuggestions);o++){var s=t({id:S.suggestion+o,tag:"div",className:v.suggestion});s.innerHTML=m.renderSuggestion(m.suggestions[o],e),h.appendChild(s)}y.appendChild(h)}function c(e){var t,n=-1;m.focusedSuggestionId&&(n=r(m.focusedSuggestionId)),t=-1===n?e?m.suggestionsCount-1:0:e?0===n?m.suggestionsCount-1:n-1:n===m.suggestionsCount-1?0:n+1,l(document.getElementById(S.suggestion+t))}function f(){var e=document.getElementById(m.focusedSuggestionId),t=r(m.focusedSuggestionId);e&&(m.onSuggestionSelection?C.value=m.onSuggestionSelection(m.suggestions[t]):C.value=e.innerText,p())}function l(e){if(e)if(0===e.id.indexOf(S.suggestion)){for(var t=h.getElementsByClassName(v.suggestion+" "+v.focused),n=0;n<t.length;n++)u(t[n],v.focused);m.focusedSuggestionId=e.id,i(e,v.focused)}else m.focusedSuggestionId=void 0}function p(){h.parentNode&&y.removeChild(h)}if(e.data||e.getSuggestions){var v={suggestion:"suggestion",focused:"focused"},S={wrapper:"autosuggest-wrapper",input:"autosuggest-input",suggestion:"suggestion-"};this.mountSelector=e.mountSelector||"#"+S.wrapper,this.onInput=e.onInput||function(){},this.getSuggestions=e.getSuggestions||function(e){var t=[];return e?(m.data.forEach(function(n){(n=m.displayProperty?g(n,m.displayProperty):n).toLowerCase().indexOf(e.toLowerCase())>-1&&t.push(n)}),t):t},this.onSuggestionSelection=e.onSuggestionSelection,this.data=e.data,this.maxSuggestions=e.maxSuggestions||20,this.renderSuggestion=e.renderSuggestion||function(e,t){return a(e,t)},this.displayProperty=e.displayProperty;var m=this,h=t({tag:"div",id:"suggestions-wrapper"}),C=t({tag:"input",id:S.input}),y=document.querySelector(m.mountSelector);y?(y.appendChild(C),m.focusedSuggestionId=void 0,m.suggestionsCount=0,C.addEventListener("keydown",function(e){38!==e.keyCode&&40!==e.keyCode||c(38===e.keyCode)}),C.addEventListener("keyup",function(e){o(e.keyCode)?d(e.target.value):13===e.keyCode&&f()}),h.addEventListener("mouseover",function(e){e.stopPropagation(),l(e.target)}),h.addEventListener("click",function(e){e.stopPropagation(),f()}),C.addEventListener("focus",function(e){e.stopPropagation(),h.parent||y.appendChild(h)}),window.addEventListener("click",function(e){y.contains(e.target)||p(e.target)})):console.error("could not render autosuggest - no mount element provided for selector "+m.mountSelector)}else console.error("could not init autosuggest - please provide either data or getSuggestions method")}