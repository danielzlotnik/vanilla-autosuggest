function Autosuggest(e){function t(e){var t=document.createElement(e.tag);for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function n(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function o(e){var t=String.fromCharCode(e);return/[a-zA-Z0-9-_ \b]/.test(t)}function s(e,t){return!!e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))}function i(e,t){s(e,t)||(e.className+=" "+t)}function u(e,t){if(s(e,t)){var n=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(n," ")}}function g(e,t){for(var n=(t=(t=t.replace(/\[(\w+)\]/g,".$1")).replace(/^\./,"")).split("."),o=0,s=n.length;o<s;++o){var i=n[o];if(!(i in e))return;e=e[i]}return e}function r(e){return e?parseInt(e.split("-")[1]):-1}function a(e,t){return e?e.replace(new RegExp(t,"ig"),"<strong>"+t+"</strong>"):""}function d(e){n(m),S.suggestions=S.getSuggestions(e),S.suggestionsCount=S.suggestions.length,S.focusedSuggestionId=void 0;for(var o=0;o<Math.min(S.suggestions.length,S.maxSuggestions);o++){var s=t({id:v.suggestion+o,tag:"div",className:h.suggestion});s.innerHTML=S.renderSuggestion(S.suggestions[o],e),m.appendChild(s)}y.appendChild(m)}function c(e){var t,n=-1;S.focusedSuggestionId&&(n=r(S.focusedSuggestionId)),t=-1===n?e?S.suggestionsCount-1:0:e?0===n?S.suggestionsCount-1:n-1:n===S.suggestionsCount-1?0:n+1,p(document.getElementById(v.suggestion+t))}function l(){var e=document.getElementById(S.focusedSuggestionId),t=r(S.focusedSuggestionId);e&&(S.onSuggestionSelection?C.value=S.onSuggestionSelection(S.suggestions[t]):C.value=e.innerText,f())}function p(e){if(e)if(0===e.id.indexOf(v.suggestion)){for(var t=m.getElementsByClassName(h.suggestion+" "+h.focused),n=0;n<t.length;n++)u(t[n],h.focused);S.focusedSuggestionId=e.id,i(e,h.focused)}else S.focusedSuggestionId=void 0}function f(){m.parentNode&&y.removeChild(m)}if(e.data||e.getSuggestions){var h={suggestion:"suggestion",focused:"focused"},v={wrapper:"autosuggest-wrapper",input:"autosuggest-input",suggestion:"suggestion-"};this.mountSelector=e.mountSelector||"#"+v.wrapper,this.onInput=e.onInput||function(){},this.getSuggestions=e.getSuggestions||function(e){var t=[];return e?(S.data.forEach(function(n){(n=S.displayProperty?g(n,S.displayProperty):n).toLowerCase().indexOf(e.toLowerCase())>-1&&t.push(n)}),t):t},this.onSuggestionSelection=e.onSuggestionSelection,this.data=e.data,this.maxSuggestions=e.maxSuggestions||20,this.renderSuggestion=e.renderSuggestion||function(e,t){return a(e,t)},this.displayProperty=e.displayProperty,this.placeholder=e.placeholder||"",this.inputClasses=e.inputClasses||"";var S=this,m=t({tag:"div",id:"suggestions-wrapper"}),C=t({tag:"input",id:v.input,placeholder:S.placeholder,className:S.inputClasses}),y=document.querySelector(S.mountSelector);y?(y.appendChild(C),S.focusedSuggestionId=void 0,S.suggestionsCount=0,C.addEventListener("keydown",function(e){38!==e.keyCode&&40!==e.keyCode||c(38===e.keyCode)}),C.addEventListener("keyup",function(e){o(e.keyCode)?d(e.target.value):13===e.keyCode&&l()}),m.addEventListener("mouseover",function(e){e.stopPropagation(),p(e.target)}),m.addEventListener("click",function(e){e.stopPropagation(),l()}),C.addEventListener("focus",function(e){e.stopPropagation(),m.parent||y.appendChild(m)}),window.addEventListener("click",function(e){y.contains(e.target)||f(e.target)})):console.error("could not render autosuggest - no mount element provided for selector "+S.mountSelector)}else console.error("could not init autosuggest - please provide either data or getSuggestions method")}